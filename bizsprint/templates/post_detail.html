{% extends "base.html" %}
{% load crispy_forms_tags %}

{% load urlify %}

{% block head_title %}
{{ instance.title }} | {{ block.super }}
{% endblock head_title %}



{% block mini %}
        <!-- Page Title
        ============================================= -->
        <section id="page-title" class="page-title-mini">

            <div class="container clearfix">
                <h1 class="biz_blue">Biz Blog</h1>

                <ol class="breadcrumb">
                    <li><a href={% url 'home' %}>Home</a></li>
                    <li class="active">Blog</li>
                </ol>
            </div>
        </section><!-- #page-title end -->

{% endblock %}

{% block content %}
<div class=".col-xs-12 .col-md-8 detail-image">
    {% if instance.image %}
    <img src='{{ instance.image.url }}' class='img-responsive' />
    {% endif %}
<h1>{{ title }} <small>{% if instance.draft %}<span style='color:red;'>Draft</span> {% endif %}{{ instance.publish }}</small></h1>
<p>Read Time: {% if instance.read_time|time:"i" <="01" %} < 1 minute {% else %}{{ instance.read_time|time:"i" }} minutes {% endif %}</p>
{% if instance.user.get_full_name %}
<p>Author: {{ instance.user.get_full_name }}</p>
{% endif %}

<p><div class="fb-like" data-href="{{ request.build_absolute_uri }}" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true"></div>
<hr/>
</p>

<div class='row'>
<div class='col-sm-12 '>

   <div class='post-detail-item'>{{ instance.get_markdown }}</div>


    <hr/>
    <br/>

     <div>

        <p class='lead'><strong>Comments:</strong></p>
     <form method="POST" action=".">{% csrf_token %}
         {{ comment_form|crispy }}
         <input type="submit" value="Post comment" class="button button-3d button-gray  nobottommargin">
     </form>
        <hr/>
        {% for comment in comments %}

        <blockquote>
          <p class="biz_blue">{{ comment.content }}</p>
          <footer>via {{ comment.user }} | {{ comment.timestamp|timesince }} ago | {% if comment.children.count > 0 %}
              {{ comment.children.count }} Comment{% if comment.children.count > 1 %}s{% endif %} | {% endif %}
              <a class="comment-reply-btn" href="#">Reply</a> | <a class="" href="{{ comment.get_absolute_url }}">Thread</a>
          </footer>
        <div class="comment-reply">
              {% for child_comment in comment.children %}
                <blockquote>
                <p class="reply_font biz_orange">{{ child_comment.content }}</p>
                <footer>via {{ child_comment.user }} | {{ child_comment.timestamp|timesince }} ago</footer>
                </blockquote>
             {% endfor %}
            <form method="POST" action=".">{% csrf_token %}
                 {{ comment_form|crispy }}
                <input type="hidden" name="parent_id" value="{{ comment.id }}">
                <input type="submit" value="Reply" class="button button-3d button-gray  nobottommargin">
            </form>
        </div>
        </blockquote>

        <hr/>
        {% endfor %}
    </div>




</div>
</div>
</div>
{% endblock %}
